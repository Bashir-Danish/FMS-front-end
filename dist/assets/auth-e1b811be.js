import{L as h,r as u,m as v,j as w,M as n}from"./index-9ea00947.js";const N=h("auth",()=>{const p=u(),t=u([]),i="false",o=v(),c=w();async function l(){try{const s=await n.get("/users");t.value=s.data.users}catch(s){console.error("Error retrieving users:",s)}}async function d(s){const r=new FormData;r.append("name",s.name),r.append("lastName",s.lastName),r.append("email",s.email),r.append("password",s.password),r.append("userType",s.userType),r.append("imagePath",s.picture);try{const e=await n.post("/users/register",r,{headers:{"Content-Type":"multipart/form-data"}});(e==null?void 0:e.status)===201&&(t.value.push({user_id:e.data.user.user_id,name:e.data.user.name,lastName:e.data.user.lastName,email:e.data.user.email,userType:e.data.user.userType,picture:e.data.user.picture}),o.setMessage("کاربر",e.data.message,!0),o.File=[])}catch(e){o.setMessage("کاربر",e.response.data.error,!1),console.error("Error creating user:",e)}}async function m(s){const r=new FormData;r.append("name",s.name),r.append("lastName",s.lastName),r.append("email",s.email),r.append("password",s.password),r.append("userType",s.userType),r.append("imagePath",s.picture);try{try{const e=await n.put(`/users/${s.user_id}`,r,{headers:{"Content-Type":"multipart/form-data"}});if((e==null?void 0:e.status)===200){const a=t.value.findIndex(y=>y.user_id===s.user_id);a!==-1&&(t.value[a].name=e.data.user.name,t.value[a].lastName=e.data.user.lastName,t.value[a].userType=e.data.user.userType,t.value[a].picture=e.data.user.picture,t.value[a].email=e.data.user.email),console.log(e.data),o.setMessage("کاربر",e.data.message,!0)}}catch(e){console.error("Error updating user:",e)}}catch(e){console.error("Error updating user:",e)}}async function g(s){try{const r=await n.delete(`/users/${s}`);(r==null?void 0:r.status)===200&&(t.value=t.value.filter(e=>e.user_id!==s),o.setMessage("کاربر",r.data.message,!0)),console.log(r)}catch(r){o.setMessage("کاربر",r.response.data.error,!1),console.error("Error deleting user:",r)}}async function f(s,r,e){try{const a=await n.post("/users/login",{email:s,password:r,remember:e});(a==null?void 0:a.status)===200&&c.push({path:"/"})}catch(a){console.error(a.response.data.error)}}return{login:f,getAllUsers:l,createUser:d,updateUser:m,deleteUser:g,isLoggedIn:p,users:t,sideBar:i}});export{N as u};
