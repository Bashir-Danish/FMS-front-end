import{d as W,p as X,m as ee,r as c,e as T,o,c as l,q as p,g as r,w as y,a as t,H as N,j as V,J as B,F as k,k as b,f as d,h as E,t as i,G as A,l as z,E as G,K as te,I as Y,x as se,y as ae,_ as ne}from"./index-19028af0.js";import{B as M}from"./baseinput-96fb8b79.js";import{d as P}from"./dropzone-189e4d25.js";import{A as oe,P as le,D as ue}from"./PencilOutline-5bef6d5a.js";import{A as de}from"./ArrowSync24Regular-83ae9bec.js";/* empty css                                                                  */const w=D=>(se("data-v-2b32638c"),D=D(),ae(),D),re={key:0,class:"Student-form-overlay"},ie={class:"student-form"},ce={key:0},pe={key:1},ve={class:"input-groups"},_e={class:"input-group"},me={class:"input-group"},fe={class:"st-input-groups"},ye={class:"input-group"},he=w(()=>t("label",{for:"dep"}," دیپارتمنت:",-1)),ge=w(()=>t("option",{value:"",selected:"",disabled:""},"دیپاتمنت",-1)),ke=["value"],be={class:"input-group"},we={class:"st-input-groups"},Se={class:"input-group"},Ce=w(()=>t("label",{for:"number"},"شماره ترم:",-1)),Ve=["value"],De={class:"input-group"},Ie=w(()=>t("label",{for:"number"}," سال:",-1)),xe=["value"],Ye={class:"image-input"},$e=w(()=>t("label",{for:"image"},"پروفایل",-1)),Fe={class:"dropzone"},Ue={class:"button-group"},qe={class:"student-list"},Be={class:"header1"},Ae={id:"name"},Me={id:"filters"},Le={class:"input-group"},Te={class:"select-o"},Ne={key:0,class:"select-ul"},Ee=["onClick"],ze={class:"input-group"},Ge={key:0,class:"select-ul"},Pe=["onClick"],Re={class:"header2"},je=te('<span id="num" data-v-2b32638c>شماره</span><span id="student-picture" data-v-2b32638c>پروفایل</span><span id="student-id" data-v-2b32638c>آیدی</span><span id="student-name" data-v-2b32638c>نام</span><span id="student-fname" data-v-2b32638c>نام پدر</span><span id="st-department" data-v-2b32638c>دیپارتمنت</span><span id="st-semester" data-v-2b32638c>سمستر</span>',7),He={id:"add-button"},Je={key:0,class:"loader"},Ke=w(()=>t("div",{class:"fulfilling-square-spinner"},[t("div",{class:"spinner-inner"})],-1)),Oe=[Ke],Ze={key:1},Qe={class:"list-item-content"},We={class:"number"},Xe={class:"student-picture"},et=["src"],tt={key:1},st={class:"student-id"},at={class:"student-name"},nt={class:"student-fname"},ot={class:"st-department"},lt={class:"st-semester"},ut={class:"edit-student-buttons"},dt=["onClick"],rt=["onClick"],it={key:2,class:"empty-list-message"},ct=W({__name:"student",setup(D){X();const a=ee(),I=c(!1),n=c({student_id:0,name:"",fname:"",ssid:0,department_id:0,picture:"",current_semester:0,year:0}),v=c(!1),_=c(!1),h=c(null),$=c(!1),F=c(!1),S=c(),C=c(),m=c(!1),R=T(()=>{if(S.value){const u=S.value.toLowerCase();return a.departments.filter(s=>{var e;return(e=s.name)==null?void 0:e.toLowerCase().includes(u)})}return a.departments}),j=T(()=>{if(C.value){const u=C.value.toLowerCase();return a.studentYears.filter(s=>s.year.toString().includes(u))}return a.studentYears}),H=async u=>{console.log(a.studentYear),m.value=!0,S.value="",a.studentDepId=u.department_id,await a.getAllStudents(a.studentDepId,a.studentYear),setTimeout(()=>{m.value=!1},1e3)},J=async u=>{console.log(a.studentYear),m.value=!0,C.value="",a.studentYear=u.year,await a.getAllStudents(a.studentDepId,a.studentYear),setTimeout(()=>{m.value=!1},1200)},K=async()=>{m.value=!0,await a.getAllStudents(a.studentDepId,a.studentYear),setTimeout(()=>{m.value=!1},1200)},O=u=>{h.value=u,n.value={...u},console.log(h.value),_.value=!0},Z=async()=>{if(v.value)try{await a.createStudent(n.value),x()}catch(u){console.error("Error creating user:",u)}else if(_.value&&h.value){try{console.log(n.value),await a.updateStudent({student_id:h.value.student_id,name:n.value.name,fname:n.value.fname,ssid:n.value.ssid,department_id:n.value.department_id,picture:n.value.picture,current_semester:n.value.current_semester,year:n.value.year}),x()}catch(u){console.error("Error updating user:",u)}n.value.name="",n.value.fname="",n.value.ssid=0,n.value.department_id=0,n.value.current_semester=0,n.value.year=0}await a.getYears()},Q=async u=>{if(window.confirm("Are you sure you want to delete this user?"))try{await a.deleteStudent(u)}catch(g){console.log(g)}await a.getYears()},x=()=>{h.value=null,n.value={student_id:0,name:"",fname:"",ssid:0,department_id:0,picture:"",current_semester:0,year:0},v.value=!1,_.value=!1,a.File=[]},L=async u=>{I.value=!0;const s=await a.uploadImage("student",u);s!==""&&(n.value.picture=s,I.value=!1)};return(u,s)=>{var g;return o(),l("div",null,[v.value||_.value?(o(),l("div",{key:0,class:"dark-container",onClick:x})):p("",!0),r(A,{name:"bounce"},{default:y(()=>[v.value||_.value?(o(),l("div",re,[t("div",ie,[v.value?(o(),l("h2",ce,"ایجاد محصل جدید")):p("",!0),_.value?(o(),l("h2",pe,"ویرایش محصل")):p("",!0),t("form",{onSubmit:s[9]||(s[9]=N(()=>{},["prevent"])),enctype:"multipart/form-data"},[t("div",ve,[t("div",_e,[r(M,{modelValue:n.value.name,"onUpdate:modelValue":s[0]||(s[0]=e=>n.value.name=e),"input-type":"text","input-id":"نام:","is-required":!0,placeholder:"نام را وارد کنید"},null,8,["modelValue"])]),t("div",me,[r(M,{modelValue:n.value.fname,"onUpdate:modelValue":s[1]||(s[1]=e=>n.value.fname=e),"input-type":"text","input-id":"نام پدر:","is-required":!0,placeholder:"نام پدر را وارد کنید"},null,8,["modelValue"])])]),t("div",fe,[t("div",ye,[he,V(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.value.department_id=e),id:"dep",required:""},[ge,(o(!0),l(k,null,b(d(a).departments,e=>(o(),l("option",{value:e.department_id,key:e.department_id},i(e.name),9,ke))),128))],512),[[B,n.value.department_id]])]),t("div",be,[r(M,{modelValue:n.value.ssid,"onUpdate:modelValue":s[3]||(s[3]=e=>n.value.ssid=e),"input-type":"number","input-id":"آیدی:","is-required":!0,placeholder:"آیدی را وارد کنید"},null,8,["modelValue"])])]),t("div",we,[t("div",Se,[Ce,V(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>n.value.current_semester=e),id:"number",required:""},[(o(),l(k,null,b(8,e=>t("option",{key:e,value:e},i(e),9,Ve)),64))],512),[[B,n.value.current_semester]])]),t("div",De,[Ie,V(t("select",{"onUpdate:modelValue":s[5]||(s[5]=e=>n.value.year=e),id:"number",required:""},[(o(),l(k,null,b(40,e=>t("option",{key:e,value:e+1380},i(e+1380),9,xe)),64))],512),[[B,n.value.year]])])]),t("div",Ye,[$e,t("div",Fe,[v.value?(o(),E(P,{key:0,store:"student",loading:I.value,onSelectImage:s[6]||(s[6]=e=>L())},null,8,["loading"])):p("",!0),_.value?(o(),E(P,{key:1,store:"student",loading:I.value,onSelectImage:s[7]||(s[7]=e=>{var f;return L((f=h.value)==null?void 0:f.student_id)})},null,8,["loading"])):p("",!0)])]),t("div",Ue,[t("button",{type:"button",onClick:s[8]||(s[8]=e=>Z())},i(v.value?"ذخیره":"ویرایش"),1),t("button",{onClick:x,type:"button"},"لغو")])],32)])])):p("",!0)]),_:1}),t("div",qe,[t("div",Be,[t("span",Ae,[z(" لیست محصلین دیپارتمنت "),t("span",null,i((g=d(a).departments.find(e=>e.department_id===d(a).studentDepId))==null?void 0:g.name),1),z(" سال "),t("span",null,i(d(a).studentYear)+" ه ش",1)]),t("span",Me,[t("div",Le,[t("div",Te,[V(t("input",{id:"dep",type:"text","onUpdate:modelValue":s[10]||(s[10]=e=>S.value=e),onFocus:s[11]||(s[11]=e=>F.value=!0),onBlur:s[12]||(s[12]=e=>F.value=!1),placeholder:"جستجوی دیپارتمنت",required:"",autocomplete:"false"},null,544),[[G,S.value]]),r(A,{name:"list",appear:""},{default:y(()=>[F.value?(o(),l("ul",Ne,[(o(!0),l(k,null,b(R.value,e=>(o(),l("li",{key:e.department_id,onClick:N(f=>H(e),["self"])},i(e.name),9,Ee))),128))])):p("",!0)]),_:1})])]),t("div",ze,[V(t("input",{id:"semester",type:"text","onUpdate:modelValue":s[13]||(s[13]=e=>C.value=e),onFocus:s[14]||(s[14]=e=>$.value=!0),onBlur:s[15]||(s[15]=e=>$.value=!1),placeholder:"جستجوی سال",required:"",autocomplete:"false"},null,544),[[G,C.value]]),r(A,{name:"list",appear:""},{default:y(()=>[$.value?(o(),l("ul",Ge,[(o(!0),l(k,null,b(j.value,(e,f)=>(o(),l("li",{key:f,onClick:U=>J(e)},i(e.year),9,Pe))),128))])):p("",!0)]),_:1})])])]),t("div",Re,[je,t("span",He,[t("button",{onClick:s[16]||(s[16]=e=>v.value=!0)},[r(d(Y),null,{default:y(()=>[r(d(oe))]),_:1})]),t("button",{onClick:K},[r(d(Y),null,{default:y(()=>[r(d(de))]),_:1})])])]),m.value?(o(),l("div",Je,Oe)):p("",!0),d(a).students.length>0?(o(),l("ul",Ze,[(o(!0),l(k,null,b(d(a).students,(e,f)=>{var U;return o(),l("li",{key:e.student_id,class:"item"},[t("div",Qe,[t("span",We,i(f+1),1),t("div",Xe,[e.picture?(o(),l("img",{key:0,src:d(a).baseUrl+e.picture,alt:"",srcset:""},null,8,et)):(o(),l("span",tt,"No picture"))]),t("p",st,i(e.ssid),1),t("p",at,i(e.name),1),t("p",nt,i(e.fname),1),t("p",ot,i((U=d(a).departments.find(q=>q.department_id===e.department_id))==null?void 0:U.name),1),t("p",lt,i(e.current_semester),1),t("div",ut,[t("button",{onClick:q=>O(e)},[r(d(Y),{size:"20",color:"green"},{default:y(()=>[r(d(le))]),_:1})],8,dt),t("button",{onClick:q=>Q(e.student_id)},[r(d(Y),{size:"20",color:"red"},{default:y(()=>[r(d(ue))]),_:1})],8,rt)])])])}),128))])):(o(),l("p",it,"خالی."))])])}}});const ht=ne(ct,[["__scopeId","data-v-2b32638c"]]);export{ht as default};
